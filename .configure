#!/bin/sh
exec > makefile
cat Makefile

. .lib.configure

for file in $srcdir/*/.configure; do
	"$file"
done

echo
echo '# Dependencies'
for file in $srcdir/*/*.c $srcdir/*/*.h; do
	for header in $(recurse_headers "$file" | sort | uniq); do
		if [ "${file%.c}.c" = "${file}" ]; then
			echo "${file%.c}.o: ${header}"
		else
			echo "${file}: ${header}"
		fi
	done
done
